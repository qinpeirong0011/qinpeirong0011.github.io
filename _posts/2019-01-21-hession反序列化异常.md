---
layout:     post
title:      dubbo反序列化异常导致服务负载飙高、吞吐率下降
date:       2019-01-21
author:     qinpr
header-img: img/post-bg-hacker.jpg
catalog: true
tags:
    - DUBBO
---

# 发现问题
  如果consumer端的pojo对象的版本号低于provider端，provider端返回consumer端不存在的pojo对象。dubbo默认用hession在consmer端反序列化时，会抛出一个warning的异常。如图：<br/>
  ![](https://qinpeirong0011.github.io/img/20190121/hession_error.png)
  
  看了下dubbo源码，发现hession在反序列化，调用Class.ForName(type, false, classLoader)失败时会抛出此异常warning。这里hession会兼容这个异常，返回空。而不像kryo等其他序列化工具那样直接返回请求失败。所以大家最好不要轻易更换dubbo序列化工具，默认选择hession，dubbo肯定是考虑的多方面的因素。这里抛出的这个异常说明在当前consumer端的classloader没有这个pojo对象。<br/>
  ![](https://qinpeirong0011.github.io/img/20190121/hession_serializer_factory.png)
